# Ansible-DevOps

    è‡ªå­¦çš„äººå¥½è‹¦é€¼å•Š, ä¸å†™ä¸ªé¡¹ç›®å‡ºæ¥éƒ½ä¸æ•¢è¯´è‡ªå·±ä¼šé…ç½®ç®¡ç†! 

    è¿™ä¸ªé¡¹ç›®çš„æœ€ç»ˆç›®çš„å°±æ˜¯ä¸ºäº†å¯ä»¥è‡ªåŠ¨åŒ–å®‰è£…ä¸€ä¸ªSSR !
    ä½ è¦åšçš„åªæ˜¯ å¼€å¯ä¸€ä¸ªæ–°çš„vps, ç„¶åæ‰§è¡Œä¸€æ¡å‘½ä»¤! 


# TODO 





# Done 

    1. Ansible æ­å»º(æœåŠ¡ç«¯+èŠ‚ç‚¹)  2017-10-28-22 âœ”ï¸





â—ï¸â—ï¸ Ansibleä¸­æ–‡æƒå¨æŒ‡å— â—ï¸â—ï¸
http://ansible-tran.readthedocs.io/en/latest/docs/intro_installation.html




â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸------â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸
ğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µ Ansible æ­å»º ğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µ
â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸------â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸

ğŸ”µ  Ansible å®‰è£… CentOS_7 âœ”ï¸

    yum install epel-release
    yum search ansible 
    yum install ansible -y
    ansible --version

ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ å¯†é’¥é…ç½® âœ”ï¸ ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶

ğŸ”¶ ç®€ä»‹

    Ansible ä¹‹æ‰€ä»¥ä¸è¦å®‰è£…å®¢æˆ·ç«¯ æ˜¯å› ä¸ºæœåŠ¡ç«¯èƒ½ç›´æ¥SSHåˆ°æ‰€æœ‰çš„å®¢æˆ·ç«¯!
    è¦å®ç°è¿™ä¸ªåŠŸèƒ½,å½“ç„¶è¦äº‹å…ˆé…ç½® SSH å¯†é’¥äº†.
    ä¹Ÿå°±æ˜¯æŠŠ æœåŠ¡ç«¯çš„å…¬é’¥ æ”¾åˆ°æ‰€æœ‰å®¢æˆ·ç«¯ä¸Šå».
    ç›®çš„: åªè¦ Ansible æœåŠ¡ç«¯ èƒ½ä¸ç”¨å¯†ç ç›´æ¥ssh åˆ°å®¢æˆ·ç«¯å°±è¡Œ. ä¸ç®¡ä»»ä½•æ–¹æ³•.

ğŸ”¶ å¯†é’¥æŠ€å·§

    å…¶å®ä¸€ä¸ªäººåªè¦ä¸€å¥—å¯†é’¥å°±å¤Ÿäº†! æ¯”å¦‚ä½ ç”¨ Macç”µè„‘ç”Ÿæˆä¸€å¥—å¯†é’¥ (å…¬é’¥+ç§é’¥)
    å¦‚æœä½ æŠŠMac çš„å…¬é’¥ä¸Šä¼ åˆ° vps1 âœ Mac  å°±å¯ä»¥SSH vps1
    å¦‚æœä½ æŠŠMac çš„å…¬é’¥ä¸Šä¼ åˆ° vps2 âœ Mac  å°±å¯ä»¥SSH vps2
    å¦‚æœä½ æŠŠMac çš„ç§é’¥ä¸Šä¼ åˆ° vps3 âœ vps3 å°±å¯ä»¥SSH Mac + vps1 + vps2 äº†

    å¦‚æœä½ æœ‰å¥½å‡ ä¸ªVPS, éœ€è¦äº’ç›¸ä¹‹é—´èƒ½ç›´æ¥SSH,
    é‚£ä¹ˆæœ€ç®€å•çš„æ–¹æ³•æ˜¯ Mac æœ¬åœ°ç”Ÿæˆä¸€å¥—å¯†é’¥, 
    æŠŠè¿™å¥—å¯†é’¥(å…¬é’¥+ç§é’¥) ä¸Šä¼ åˆ° æ‰€æœ‰çš„VPS, 
    ç„¶åæ‰€æœ‰VPS å°±å¯ä»¥äº’ç›¸SSHäº†


ğŸ”¶ ç”Ÿæˆå¯†é’¥ 

    â€¢ å¯†é’¥ç”Ÿæˆ ğŸ”… ssh-keygen -t rsa
    â€¢ å…¬é’¥ä½ç½® ~/.ssh/id_rsa.pub
    â€¢ ç§é’¥ä½ç½® ~/.ssh/id_rsa  âš¡ æœ¬æ–‡ä»¶éå¸¸é‡è¦,ä¸€èˆ¬ç»å¯¹ä¸èƒ½å¤–æ³„.

    âš¡ ä¸ç®¡æ˜¯Mac è¿˜æ˜¯ Linux ç”Ÿæˆå¯†é’¥çš„å‘½ä»¤éƒ½æ˜¯ä¸€æ ·çš„! 

ğŸ”¶ å¯†é’¥ä¸Šä¼  +  authorized_keys  + é‡å¯SSH 

    ç”¨ scp å‘½ä»¤æŠŠæœåŠ¡å™¨çš„å…¬é’¥ä¼ è¾“åˆ°æ‰€æœ‰å®¢æˆ·ç«¯ä¸Š! 
    ä¸‹é¢å‘½ä»¤æ˜¯æŠŠæœ¬åœ°çš„å¯†é’¥ä¸Šä¼ åˆ°æœåŠ¡å™¨ root ç”¨æˆ·çš„ ~/.ssh/ ç›®å½•ä¸‹
    ç”±äºæœåŠ¡å™¨æ˜¯ssh ç«¯å£ä¸ºäº†å®‰å…¨æ”¹æˆ 2190 äº† æ‰€ä»¥éœ€è¦ -P 2190 å‚æ•°

    å½“ç„¶ ç°åœ¨è¿˜ä¸èƒ½äº’ç›¸SSH, å…¬é’¥ä¸Šä¼ åªæ˜¯ç¬¬ä¸€æ­¥. 
    è¿˜è¦åœ¨æœåŠ¡å™¨ä¸ŠæŠŠ å…¬é’¥æ·»åŠ åˆ° authorized_keys é‡Œé¢.
    ä»»ä½•å®¢æˆ·ç«¯æƒ³è¦sshè¿›æœåŠ¡å™¨, æœåŠ¡å™¨é¦–å…ˆæŸ¥çš„å°±æ˜¯è¿™ä¸ª authorized_keys æ–‡ä»¶. 
    å¦‚æœè¿™ä¸ªæ–‡ä»¶é‡Œé¢ æœ‰å®¢æˆ·ç«¯çš„å…¬é’¥, é‚£ä¹ˆå°±å…è®¸SSHè¿æ¥! 

    authorized_keys è¿™æ­¥æ˜¯åœ¨å¯¹æ–¹æœåŠ¡å™¨ä¸Šè®¾ç½®çš„. 
    æ¯”å¦‚æˆ‘Mac è¦ SSH åˆ° GCE , é‚£ä¹ˆå°±å»GCEè®¾ç½®è¿™æ­¥!
    GCEæ˜¯æœåŠ¡å™¨. ç„¶åå¾ˆå¤šå‘˜å·¥éƒ½è¦SSH åˆ°è¿™ä¸ªæœåŠ¡å™¨. æ‰€ä»¥GCEæœåŠ¡å™¨ä¸Šä¼šæœ‰å¾ˆå¤š å…¬é’¥!
    å› ä¸ºæ¯ä¸ªå‘˜å·¥éƒ½ä¼šç”Ÿæˆä¸€å¥—è‡ªå·±çš„å¯†é’¥å¯¹,ç§é’¥è‡ªå·±ä¿å­˜, å…¬é’¥ä¸Šä¼ åˆ°GCE ä¸Šé¢.
    æ¯ä¸ªå‘˜å·¥éƒ½éœ€è¦æŠŠè‡ªå·±çš„å…¬é’¥ ç”¨ä¸‹é¢å‘½ä»¤è¿½åŠ åˆ°æœåŠ¡å™¨GCEçš„ authorized_keys æ–‡ä»¶ä¸­
    cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys

    â€¢ GCE æœåŠ¡å™¨é…ç½® (Ansible å®‰è£…åœ¨æ­¤)
    ğŸ”… æœ¬åœ° âœ scp -P 2190 -r ~/.ssh/id_rsa.pub root@35.194.128.92:~/.ssh/
    ğŸ”… æœ¬åœ° âœ scp -P 2190 -r ~/.ssh/id_rsa root@35.194.128.92:~/.ssh/
    ğŸ”… è¿œç«¯ âœ cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys
    ğŸ”… è¿œç«¯ âœ /bin/systemctl restart  sshd.service

    â€¢ vps1 æœåŠ¡å™¨é…ç½®
    ğŸ”… æœ¬åœ° âœ scp -P 2222 -r ~/.ssh/id_rsa.pub root@23.105.192.96:~/.ssh/
    ğŸ”… æœ¬åœ° âœ scp -P 2222 -r ~/.ssh/id_rsa root@23.105.192.96:~/.ssh/
    ğŸ”… è¿œç«¯ âœ cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys
    ğŸ”… è¿œç«¯ âœ /bin/systemctl restart  sshd.service

    â€¢ vps2 æœåŠ¡å™¨é…ç½®
    ğŸ”… æœ¬åœ° âœ scp -P 2222 -r ~/.ssh/id_rsa.pub root@104.224.139.45:~/.ssh/
    ğŸ”… æœ¬åœ° âœ scp -P 2222 -r ~/.ssh/id_rsa root@104.224.139.45:~/.ssh/
    ğŸ”… è¿œç«¯ âœ cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys
    ğŸ”… è¿œç«¯ âœ /bin/systemctl restart  sshd.service

    â€¢ aws æœåŠ¡å™¨é…ç½® âœ”ï¸ 
    âš¡ AWS é»˜è®¤æ˜¯åªèƒ½ç”¨ å¯†é’¥ ç™»å½•çš„, è€Œä¸”è¿™ä¸ªå¯†é’¥è¿˜æ˜¯ AWSç”Ÿæˆçš„.
    âš¡ æ‰€ä»¥å°±ä¸èƒ½åœ¨Mac æœ¬åœ° ç”¨scp å‘½ä»¤æŠŠå…¬é’¥ä¸Šä¼ åˆ° aws
    âš¡ è€Œæ˜¯è¦åœ¨ aws ç”¨ scp å‘½ä»¤ä»æŸä¸ªæœ‰å…¬ç½‘IPçš„ç”µè„‘(æ¯”å¦‚ vps1) ä¸‹è½½å¯†é’¥äº†!
    scp ä¸Šä¼ å‘½ä»¤è¯­æ³• scp PathA user@IP:PathB   âœ æŠŠA æ–‡ä»¶ ä¸Šä¼ åˆ°å¯¹æ–¹çš„B è·¯å¾„ä¸‹
    scp ä¸‹è½½å‘½ä»¤è¯­æ³• scp username@IP:pathB PathA âœ ä»å¯¹æ–¹B æ–‡ä»¶å¤¹ ä¸‹è½½å†…å®¹åˆ°æœ¬åœ°çš„A

    ğŸ”… AWS âœ scp -P 2222 root@23.105.192.96:~/.ssh/id_rsa.pub ~/.ssh/
    ğŸ”… AWS âœ scp -P 2222 root@23.105.192.96:~/.ssh/id_rsa ~/.ssh/
    ğŸ”… AWS âœ cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys
    ğŸ”… AWS âœ /bin/systemctl restart  sshd.service

    Mac å°±èƒ½ç”¨ ssh root@13.115.230.116 ç™»å½• AWSäº†.
    å½“ç„¶æœ€é‡è¦çš„æ˜¯ Ansible æœåŠ¡ç«¯ èƒ½ssh aws



ğŸ”¶ SSH æµ‹è¯•

    âœ˜âœ˜âˆ™ğ’—2 ~ âœ ssh -p 2222 root@23.105.192.96
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!
    Someone could be eavesdropping on you right now (man-in-the-middle attack)!
    It is also possible that a host key has just been changed.
    The fingerprint for the RSA key sent by the remote host is
    83:f4:2f:ae:7e:98:71:7c:95:42:ca:f6:88:27:9a:48.
    Please contact your system administrator.
    Add correct host key in /root/.ssh/known_hosts to get rid of this message.
    Offending RSA key in /root/.ssh/known_hosts:2
    RSA host key for [23.105.192.96]:2222 has changed and you have requested strict checking.
    Host key verification failed.

    è¿™ä¸ªé”™è¯¯å°±åªè¦åœ¨æœ¬åœ° rm /root/.ssh/known_hosts 
    è¿™ä¸ªæ–‡ä»¶æ²¡å•¥ç”¨çš„! ç¬¬ä¸€æ¬¡è¿æœåŠ¡å™¨ä¼šè®°å½•å¯¹æ–¹çš„ä¸€äº›ä¿¡æ¯åˆ°æœ¬åœ°è€Œå·².




ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ Ansible èŠ‚ç‚¹é…ç½® âœ”ï¸ ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶

ğŸ”¶ Why

    æœåŠ¡å™¨å¿…é¡»è¦çŸ¥é“å“ªäº›èŠ‚ç‚¹æ˜¯å½’è‡ªå·±ç®¡ç†çš„. 
    Ansible æœåŠ¡ç«¯å®‰è£…å¥½åä¼šæœ‰ä¸ª hosts æ–‡ä»¶.
    ä¿®æ”¹è¿™ä¸ªé…ç½®æ¥é…ç½®èŠ‚ç‚¹. vi /etc/ansible/hosts


ğŸ”¶ å¦‚ä½•é…ç½® 

    [webservers]
    alpha.example.org
    beta.example.org
    192.168.1.100
    192.168.1.110

    [vpses]                æ˜¯ç»„å.éšæ„å– 
    vps1 vps2              æ˜¯ä¸»æœºå. éšæ„å–
    ansible_ssh_host       æŒ‡å®šæœåŠ¡å™¨ ip
    ansible_ssh_port=2222  æŒ‡å®šæœåŠ¡å™¨ssh ç«¯å£
    ansible_ssh_user       æŒ‡å®šæœåŠ¡å™¨ssh ç”¨æˆ·
    
    âš¡ å¤§æ¦‚å°±æ˜¯å®šä¹‰ä¸€ä¸ªç»„æ¥åŒºåˆ†èŠ‚ç‚¹. ç»„ä¸‹é¢å¯ä»¥å†™IP, ä¹Ÿèƒ½äº›åŸŸå.
    âš¡ ç›®çš„å°±æ˜¯èƒ½è¿ä¸ŠèŠ‚ç‚¹æœåŠ¡å™¨çš„ssh. é»˜è®¤22ç«¯å£çš„è¯ å¯ä»¥ä¸å†™ç«¯å£.
    âš¡ å¦‚æœSSHä¸æ˜¯ 22 ç«¯å£, å°±éœ€è¦è·Ÿä¸Šç«¯å£å·å¦‚:  23.105.192.96:2222


ğŸ”µ å®é™…é…ç½®

    vi /etc/ansible/hosts

        [vps1]
        23.105.192.96:2222

        [vps2]
        104.224.139.45:2222

        [aws]
        13.115.230.116


ğŸ”µ èŠ‚ç‚¹æµ‹è¯• (åœ¨ ansible æœåŠ¡ç«¯ä¸Šè¿›è¡Œ)

    â¦¿ ansible -m ping 'vps1' âœ”ï¸
        23.105.192.96 | SUCCESS => {
            "changed": false,
            "failed": false,
            "ping": "pong"
        }

    â¦¿ ansible -m ping 'vps2' âœ”  ï¸
        104.224.139.45 | SUCCESS => {
            "changed": false,
            "failed": false,
            "ping": "pong"
        }

    â¦¿ ansible -m ping 'aws' ğŸ‘¹
        13.115.230.116 | FAILED! => {
            "changed": false,
            "failed": true,
            "module_stderr": "Shared connection to 13.115.230.116 closed.\r\n",
            "module_stdout": "/bin/sh: 1: /usr/bin/python: not found\r\n",
            "msg": "MODULE FAILURE",
            "rc": 0
        }

    ä¸ºä»€ä¹ˆä¼šæŠ¥é”™å‘¢! æ˜æ˜ GCEä¸Šæ˜¯å¯ä»¥ç›´æ¥SSH AWSçš„. çœ‹è¿”å›çš„æŠ¥é”™ä¿¡æ¯å§! 
    "module_stdout": "/bin/sh: 1: /usr/bin/python: not found\r\n",
    ä¼°è®¡æ˜¯python æ²¡è£…! å› ä¸º AWSæ˜¯æ–°ç³»ç»Ÿ.. çœ‹çœ‹å»..

ğŸ”¶ Ubuntu å®‰è£… Python 2.7 (å¿½ç•¥è¿™æ­¥! Ubuntu è‡ªå¸¦ Python 3.5 çš„)
    
    â˜…â˜…â˜…â˜…â˜… å‚è€ƒ: https://vimsky.com/article/3577.html

    â¦¿ å®‰è£…ä¾èµ–!

        sudo apt-get install build-essential checkinstall

        sudo apt-get install libreadline-gplv2-dev libncursesw5-dev libssl-dev libsqlite3-dev tk-dev libgdbm-dev libc6-dev libbz2-dev

    â¦¿ ä¸‹è½½ Python 

        version=2.7.13
        wget https://www.python.org/ftp/python/$version/Python-$version.tgz

    â¦¿ è§£å‹å¹¶cdåˆ°ç›¸åº”çš„ç›®å½•

        tar -xvf Python-$version.tgz
        cd Python-$version

    â¦¿ ç”¨checkinstall å‘½ä»¤æ¥å®‰è£…,è¿™ä¸­å®‰è£…æ–¹å¼çš„å¥½å¤„æ˜¯åœ¨éœ€è¦æ—¶æ›´å®¹æ˜“å¸è½½

        ./configure
        make
        sudo checkinstall

        **********************************************************************

        Done. The new package has been installed and saved to

        /root/Python-2.7.13/python_2.7.13-1_amd64.deb

        You can remove it from your system anytime using:

            dpkg -r python

        **********************************************************************

ğŸ”¶ AWS èŠ‚ç‚¹å†æ¬¡æµ‹è¯• ğŸ‘¹

    è¿˜æ˜¯ä¸€æ ·çš„æŠ¥é”™ 
    é‚£ä¹ˆä¼°è®¡æ˜¯Python è·¯å¾„é—®é¢˜äº†.
    CentOS çš„ python æ˜¯ usr/bin/python
    ubuntu çš„ Python æ˜¯ usr/local/bin/python     

    æ˜¯ä¸æ˜¯åˆ›å»ºä¸ª å¿«æ·æ–¹å¼ å°±å¯ä»¥äº†å‘¢...
    è¿˜æ˜¯å…ˆè°·æ­Œä¸‹è¿™ä¸ªé”™è¯¯å§  "module_stdout": "/bin/sh: 1: /usr/bin/python: not found\r\n" 

    å‘ç°åªè¦åœ¨ host æ–‡ä»¶é‡Œé¢æŒ‡å®špython è·¯å¾„å°±å¯ä»¥äº†! 
    åŠ ä¸¤è¡Œ, å¤§æ¦‚å°±æ˜¯ aws è¿™ç»„, æ·»åŠ ä¸€ä¸ªå˜é‡: vars. å˜é‡å°±æ˜¯python2.7 çš„è·¯å¾„

    [aws:vars]
    ansible_python_interpreter=/usr/local/bin/python

ğŸ”¶ AWS èŠ‚ç‚¹å†æ¬¡ ping æµ‹è¯• âœ”ï¸

    âœ˜âœ˜âˆ™GCE ansible âœ ansible -m ping 'aws'
    13.115.230.116 | SUCCESS => {
        "changed": false,
        "failed": false,
        "ping": "pong"
    }    


ğŸ”¶ AWS èŠ‚ç‚¹ å†…å­˜ä½¿ç”¨æƒ…å†µ

    âœ˜âœ˜âˆ™GCE ansible âœ ansible -m shell -a 'free -m' 'aws'
    13.115.230.116 | SUCCESS | rc=0 >>
                total        used        free      shared  buff/cache   available
    Mem:            990          75         257           4         658         711
    Swap:             0           0           0

    âš¡ åˆ°è¿™é‡ŒAnsible å°±æ­å»ºå¥½äº†! æ²¡é”™! å°±æ­å»ºå¥½äº†.... å‰©ä¸‹çš„å°±æ˜¯æ€ä¹ˆä½¿ç”¨äº†


â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸------â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸
ğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µ Ansible åŸºç¡€çŸ¥è¯† ğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µ
â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸------â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸

ğŸ”¶ ç®€ä»‹

    åªè¦ Ansible èƒ½æˆåŠŸè¿ä¸Šå®¢æˆ·ç«¯, é‚£ä¹ˆå°±ç®—æ­å»ºæˆåŠŸäº†! éå¸¸ç®€å•çš„!
    å½“ç„¶ä¼šæ­å»º ä¸ç­‰äºè¯´ä½ ä¼š Ansible äº†...  è¿çš®æ¯›éƒ½è¿˜æ²¡å­¦ä¼šå‘¢..ç»§ç»­...
    é€šè¿‡ä¸Šé¢çš„æ­å»º,å¯¹Ansible è¿˜æ˜¯æ²¡å•¥äº†è§£! é¦–å…ˆæˆ‘ä»¬å…ˆå­¦ä¸‹ Ansible åŸºç¡€! 


ğŸ”¶ é…ç½®ç®¡ç†

    é…ç½®ç®¡ç†ç³»ç»Ÿæ—¨åœ¨ä½¿ç®¡ç†å‘˜å’Œæ“ä½œå›¢é˜Ÿèƒ½å¤Ÿè½»æ¾åœ°æ§åˆ¶å¤§é‡æœåŠ¡å™¨ã€‚
    å®ƒä»¬å…è®¸æ‚¨ä»ä¸€ä¸ªä¸­å¿ƒä½ç½®ä»¥è‡ªåŠ¨æ–¹å¼æ§åˆ¶è®¸å¤šä¸åŒçš„ç³»ç»Ÿã€‚

    é…ç½®ç®¡ç†é‚£ä¹ˆå¤š: Puppetã€Ansibleã€Chef....
    Puppet å¤ªé‡é‡çº§äº†,è€Œä¸”è›®å¤æ‚çš„! 
    è°·æ­Œå¾ˆå¤šå¹´å‰å°±ç”¨ Puppet ç®¡ç†6000+å° Mac æ¡Œé¢ç”µè„‘.
    é€‚åˆäººå®¶å¤§å…¬å¸çš„ä¸ä¸€å®šé€‚åˆä¸­å°å…¬å¸!!!
    Ansible åº”è¯¥æ˜¯ä¸­å°å…¬å¸æœ€ä½³çš„é€‰æ‹©. Chef.. æ²¡å•¥äº†è§£...
    è‡ªå·±è¿™æ°´å¹³ä¹Ÿè¿›ä¸äº†å¤§å…¬å¸,äºæ˜¯å°±é€‰æ‹©äº† Ansible.

    Ansible æœ€å¤§çš„ä¼˜ç‚¹æ˜¯ä¸éœ€è¦åœ¨èŠ‚ç‚¹ä¸­å®‰è£…ä»»ä½•å®¢æˆ·ç«¯ã€‚å®ƒä½¿ç”¨SSHæ¥å’ŒèŠ‚ç‚¹è¿›è¡Œé€šä¿¡ã€‚


ğŸ”¶ Ansible 
    
    è‡ªåŠ¨åŒ–è¿ç»´å·¥å…·!  åŸºäºPythonå¼€å‘çš„.
    éå¸¸è½»é‡! æ­å»ºåªéœ€ä¸‹é¢ä¸¤æ­¥!  æ— é¡»åœ¨è¢«æ§ä¸»æœºå®‰è£…ä»»ä½•è½¯ä»¶. 
        1. ç®¡ç†èŠ‚ç‚¹å®‰è£… Ansible, 
        2. ç®¡ç†èŠ‚ç‚¹é…ç½®è¢«æ§ä¸»æœºçš„ SSH å°±ç®—æ­å¥½äº†.

    
ğŸ”¶ Playbook å‰§æœ¬

    æŒ‰ç…§ è®¾å®šçš„é¡ºåº æ‰§è¡Œä»»åŠ¡! 


ğŸ”¶ Ansible å‘½ä»¤

  â¦¿ åŸºç¡€ç”¨æ³•
    ansible -m ping all         æ‰€æœ‰ä¸»æœº
    ansible -m ping vpses       æŒ‡å®šä¸€ä¸ªç»„
    ansible -m ping vps1        æŒ‡å®šå•ä¸ªä¸»æœº  
    ansible -m ping vps1:vps2   æŒ‡å®šå¤šä¸ªä¸»æœº


    ansible -m shell -a 'free -m' host1
    ä¾‹å¦‚ï¼Œè¦æ‰¾å‡ºæˆ‘ä»¬çš„host1æœºå™¨ä¸Šçš„å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ï¼š




ğŸ”¸ åŸºæœ¬ä½¿ç”¨

â¦¿ æ£€æŸ¥AnsibleèŠ‚ç‚¹çš„è¿è¡Œæ—¶é—´ï¼ˆuptime):
ansible -m command -a "uptime" 'dbservers'


â¦¿ æ£€æŸ¥èŠ‚ç‚¹çš„å†…æ ¸ç‰ˆæœ¬
ansible -m command -a "uname -r" 'dbservers'


â¦¿ ç»™èŠ‚ç‚¹å¢åŠ ç”¨æˆ·
ansible -m command -a "useradd david" 'dbservers'



â¦¿ é‡å®šå‘è¾“å‡ºåˆ°æ–‡ä»¶ä¸­
ansible -m command -a "df -Th" 'dbservers' > /tmp/command-output.txt

 cat /tmp/command-output.txt
















ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶  è½¯ä»¶å®‰è£…  ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶






